\hypertarget{configreader_8hpp_source}{}\doxysection{configreader.\+hpp}
\label{configreader_8hpp_source}\index{io/configreader.hpp@{io/configreader.hpp}}
\mbox{\hyperlink{configreader_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright (c) Stanford University, The Regents of the University of}}
\DoxyCodeLine{2 \textcolor{comment}{//               California, and others.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// All Rights Reserved.}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// See Copyright-\/SimVascular.txt for additional details.}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining}}
\DoxyCodeLine{9 \textcolor{comment}{// a copy of this software and associated documentation files (the}}
\DoxyCodeLine{10 \textcolor{comment}{// "{}Software"{}), to deal in the Software without restriction, including}}
\DoxyCodeLine{11 \textcolor{comment}{// without limitation the rights to use, copy, modify, merge, publish,}}
\DoxyCodeLine{12 \textcolor{comment}{// distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{13 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject}}
\DoxyCodeLine{14 \textcolor{comment}{// to the following conditions:}}
\DoxyCodeLine{15 \textcolor{comment}{//}}
\DoxyCodeLine{16 \textcolor{comment}{// The above copyright notice and this permission notice shall be included}}
\DoxyCodeLine{17 \textcolor{comment}{// in all copies or substantial portions of the Software.}}
\DoxyCodeLine{18 \textcolor{comment}{//}}
\DoxyCodeLine{19 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "{}AS}}
\DoxyCodeLine{20 \textcolor{comment}{// IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED}}
\DoxyCodeLine{21 \textcolor{comment}{// TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A}}
\DoxyCodeLine{22 \textcolor{comment}{// PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER}}
\DoxyCodeLine{23 \textcolor{comment}{// OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,}}
\DoxyCodeLine{24 \textcolor{comment}{// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,}}
\DoxyCodeLine{25 \textcolor{comment}{// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR}}
\DoxyCodeLine{26 \textcolor{comment}{// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF}}
\DoxyCodeLine{27 \textcolor{comment}{// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING}}
\DoxyCodeLine{28 \textcolor{comment}{// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}}
\DoxyCodeLine{29 \textcolor{comment}{// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}\textcolor{comment}{}}
\DoxyCodeLine{30 \textcolor{comment}{/**}}
\DoxyCodeLine{31 \textcolor{comment}{ * @file configreader.hpp}}
\DoxyCodeLine{32 \textcolor{comment}{ * @brief IO::ConfigReader source file}}
\DoxyCodeLine{33 \textcolor{comment}{ */}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#ifndef SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#define SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include "{}../helpers/debug.hpp"{}}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include "{}../helpers/startswith.hpp"{}}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#include "{}../model/block.hpp"{}}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#include "{}../model/bloodvessel.hpp"{}}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#include "{}../model/bloodvesseljunction.hpp"{}}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#include "{}../model/closedloopRCRbc.hpp"{}}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#include "{}../model/closedloopcoronarybc.hpp"{}}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#include "{}../model/closedloopheartpulmonary.hpp"{}}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#include "{}../model/flowreferencebc.hpp"{}}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#include "{}../model/junction.hpp"{}}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#include "{}../model/model.hpp"{}}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#include "{}../model/node.hpp"{}}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#include "{}../model/openloopcoronarybc.hpp"{}}}
\DoxyCodeLine{54 \textcolor{preprocessor}{\#include "{}../model/pressurereferencebc.hpp"{}}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#include "{}../model/resistancebc.hpp"{}}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#include "{}../model/resistivejunction.hpp"{}}}
\DoxyCodeLine{57 \textcolor{preprocessor}{\#include "{}../model/windkesselbc.hpp"{}}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#include "{}simdjson.h"{}}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_i_o}{IO}} \{}
\DoxyCodeLine{61 \textcolor{comment}{}}
\DoxyCodeLine{62 \textcolor{comment}{/**}}
\DoxyCodeLine{63 \textcolor{comment}{ * @brief svZeroDSolver configuration reader.}}
\DoxyCodeLine{64 \textcolor{comment}{ *}}
\DoxyCodeLine{65 \textcolor{comment}{ * @tparam T Scalar type (e.g. `float`, `double`)}}
\DoxyCodeLine{66 \textcolor{comment}{ */}}
\DoxyCodeLine{67 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{68 \textcolor{keyword}{class }\mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader}} \{}
\DoxyCodeLine{69  \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{70 \textcolor{comment}{  /**}}
\DoxyCodeLine{71 \textcolor{comment}{   * @brief Construct a new Config Reader object}}
\DoxyCodeLine{72 \textcolor{comment}{   */}}
\DoxyCodeLine{73   \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}();}
\DoxyCodeLine{74 \textcolor{comment}{}}
\DoxyCodeLine{75 \textcolor{comment}{  /**}}
\DoxyCodeLine{76 \textcolor{comment}{   * @brief Destroy the Config Reader object}}
\DoxyCodeLine{77 \textcolor{comment}{   */}}
\DoxyCodeLine{78   \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{\string~ConfigReader}}();}
\DoxyCodeLine{79 \textcolor{comment}{}}
\DoxyCodeLine{80 \textcolor{comment}{  /**}}
\DoxyCodeLine{81 \textcolor{comment}{   * @brief Create model from configuration file}}
\DoxyCodeLine{82 \textcolor{comment}{   *}}
\DoxyCodeLine{83 \textcolor{comment}{   * @return Model}}
\DoxyCodeLine{84 \textcolor{comment}{   */}}
\DoxyCodeLine{85   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_i_o_1_1_config_reader_a44d1b9249fc80c0e65a6267b42597bdb}{load}}(std::string \&specifier);}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} *\mbox{\hyperlink{class_i_o_1_1_config_reader_ae442b4d3b3c7891a0584bd6fbf895dce}{model}};           \textcolor{comment}{///< Simulation model}}
\DoxyCodeLine{88   \mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_state}{ALGEBRA::State<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_abe9831cb10972b4982a766aac615cb6c}{initial\_state}};  \textcolor{comment}{///< Initial state}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90   T \mbox{\hyperlink{class_i_o_1_1_config_reader_aaa79d0afffb88356f8d4ccbb7628309f}{sim\_cardiac\_cycle\_period}};  \textcolor{comment}{///< Cardiac cycle period.}}
\DoxyCodeLine{91   T \mbox{\hyperlink{class_i_o_1_1_config_reader_a8ad19204e82a0f29790452485f36a2ba}{sim\_time\_step\_size}};        \textcolor{comment}{///< Simulation time step size}}
\DoxyCodeLine{92   T \mbox{\hyperlink{class_i_o_1_1_config_reader_a46b1de73e58adb34d4e783e83e1e22e9}{sim\_abs\_tol}};               \textcolor{comment}{///< Absolute tolerance for simulation}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a4d7c56de89d9e7719726b9c620a92845}{sim\_num\_cycles}};      \textcolor{comment}{///< Number of cardiac cycles to simulate}}
\DoxyCodeLine{95   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_af4bde4c7696a7af78e607707e111f5b9}{sim\_pts\_per\_cycle}};   \textcolor{comment}{///< Number of time steps per cardiac cycle}}
\DoxyCodeLine{96   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a77fc4400616332eef67acb58ad071208}{sim\_num\_time\_steps}};  \textcolor{comment}{///< Total number of time steps}}
\DoxyCodeLine{97   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a4e0c08c222cc1ede5011c867d22a7f9d}{sim\_nliter}};          \textcolor{comment}{///< Maximum number of non-\/linear iterations in time}\textcolor{comment}{}}
\DoxyCodeLine{98 \textcolor{comment}{                           ///< integration}}
\DoxyCodeLine{99 \textcolor{comment}{}  \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_adf7c3390971a4ce76c8d4d7a6bd24cc1}{output\_interval}};     \textcolor{comment}{///< Interval of writing output}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a1e593472af26af8f4bf98b158d996434}{sim\_steady\_initial}};  \textcolor{comment}{///< Start from steady solution}}
\DoxyCodeLine{102   \textcolor{keywordtype}{bool}}
\DoxyCodeLine{103       \mbox{\hyperlink{class_i_o_1_1_config_reader_acfee0686c847138a19ad12ad71d57750}{output\_variable\_based}};  \textcolor{comment}{///< Output variable based instead of vessel based}}
\DoxyCodeLine{104   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a4b5b5b7b81108221d204840937dbad35}{output\_mean\_only}};      \textcolor{comment}{///< Output only the mean value}}
\DoxyCodeLine{105   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a77d8dac5655f87b49476fd4f40029bb6}{output\_derivative}};     \textcolor{comment}{///< Output derivatives}}
\DoxyCodeLine{106   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_ad872723e0b5862abc77290a2152556f0}{output\_last\_cycle\_only}};  \textcolor{comment}{///< Output only the last cardiac cycle}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a8d0522c13e13fda51056fd9ff111dc88}{sim\_coupled}};  \textcolor{comment}{///< Running 0D simulation coupled with external solver}}
\DoxyCodeLine{109   T \mbox{\hyperlink{class_i_o_1_1_config_reader_ab1887c05ac836540409b779768181c08}{sim\_external\_step\_size}};  \textcolor{comment}{///< Step size of external solver if running}\textcolor{comment}{}}
\DoxyCodeLine{110 \textcolor{comment}{                             ///< coupled}}
\DoxyCodeLine{111 \textcolor{comment}{}\};}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{114 \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader<T>::ConfigReader}}() \{\}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{117 \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{ConfigReader<T>::\string~ConfigReader}}() \{\}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{120 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_i_o_1_1_config_reader_a44d1b9249fc80c0e65a6267b42597bdb}{ConfigReader<T>::load}}(std::string \&specifier) \{}
\DoxyCodeLine{121   DEBUG\_MSG(\textcolor{stringliteral}{"{}Start ConfigReader::load"{}});}
\DoxyCodeLine{122   \textcolor{comment}{// Initialize model pointer}}
\DoxyCodeLine{123   model = \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}}();}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{comment}{// Create iterator for json configuration}}
\DoxyCodeLine{126   simdjson::ondemand::parser parser;}
\DoxyCodeLine{127   simdjson::padded\_string string;}
\DoxyCodeLine{128   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_h_e_l_p_e_r_s_aa60c2dfbfc096834b6cd243f84b9c47b}{HELPERS::startswith}}(specifier, \textcolor{stringliteral}{"{}\{"{}})) \{}
\DoxyCodeLine{129     \textcolor{keywordtype}{string} = simdjson::padded\_string(specifier);}
\DoxyCodeLine{130   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{131     \textcolor{keywordtype}{string} = simdjson::padded\_string::load(specifier);}
\DoxyCodeLine{132   \}}
\DoxyCodeLine{133   DEBUG\_MSG(\textcolor{stringliteral}{"{}Loaded svZeroD config file. Starting parsing."{}});}
\DoxyCodeLine{134   \textcolor{keyword}{auto} config = parser.iterate(\textcolor{keywordtype}{string});}
\DoxyCodeLine{135 }
\DoxyCodeLine{136   \textcolor{comment}{// Load simulation parameters}}
\DoxyCodeLine{137   \textcolor{keyword}{auto} sim\_params = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}];}
\DoxyCodeLine{138   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{139     sim\_coupled = sim\_params[\textcolor{stringliteral}{"{}coupled\_simulation"{}}].get\_bool();}
\DoxyCodeLine{140   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{141     sim\_coupled = \textcolor{keyword}{false};}
\DoxyCodeLine{142   \}}
\DoxyCodeLine{143   \textcolor{keywordflow}{if} (!sim\_coupled) \{}
\DoxyCodeLine{144     sim\_num\_cycles = sim\_params[\textcolor{stringliteral}{"{}number\_of\_cardiac\_cycles"{}}].get\_int64();}
\DoxyCodeLine{145     sim\_pts\_per\_cycle =}
\DoxyCodeLine{146         sim\_params[\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}].get\_int64();}
\DoxyCodeLine{147     sim\_num\_time\_steps = (sim\_pts\_per\_cycle -\/ 1.0) * sim\_num\_cycles + 1.0;}
\DoxyCodeLine{148     sim\_external\_step\_size = 0.0;}
\DoxyCodeLine{149   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{150     sim\_num\_cycles = 1;}
\DoxyCodeLine{151     sim\_num\_time\_steps = sim\_params[\textcolor{stringliteral}{"{}number\_of\_time\_pts"{}}].get\_int64();}
\DoxyCodeLine{152     sim\_pts\_per\_cycle = sim\_num\_time\_steps;}
\DoxyCodeLine{153     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{154       sim\_external\_step\_size = sim\_params[\textcolor{stringliteral}{"{}external\_step\_size"{}}].get\_double();}
\DoxyCodeLine{155     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{156       sim\_external\_step\_size = 0.1;}
\DoxyCodeLine{157     \}}
\DoxyCodeLine{158   \}}
\DoxyCodeLine{159   sim\_cardiac\_cycle\_period = -\/1.0;  \textcolor{comment}{// Negative value indicates this has not}}
\DoxyCodeLine{160                                     \textcolor{comment}{// been read from config file yet.}}
\DoxyCodeLine{161   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{162     sim\_abs\_tol = sim\_params[\textcolor{stringliteral}{"{}absolute\_tolerance"{}}].get\_double();}
\DoxyCodeLine{163   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{164     sim\_abs\_tol = 1e-\/8;}
\DoxyCodeLine{165   \}}
\DoxyCodeLine{166   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{167     sim\_nliter = sim\_params[\textcolor{stringliteral}{"{}maximum\_nonlinear\_iterations"{}}].get\_int64();}
\DoxyCodeLine{168   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{169     sim\_nliter = 30;}
\DoxyCodeLine{170   \}}
\DoxyCodeLine{171   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{172     sim\_steady\_initial = sim\_params[\textcolor{stringliteral}{"{}steady\_initial"{}}].get\_bool();}
\DoxyCodeLine{173   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{174     sim\_steady\_initial = \textcolor{keyword}{true};}
\DoxyCodeLine{175   \}}
\DoxyCodeLine{176   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{177     output\_variable\_based = sim\_params[\textcolor{stringliteral}{"{}output\_variable\_based"{}}].get\_bool();}
\DoxyCodeLine{178   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{179     output\_variable\_based = \textcolor{keyword}{false};}
\DoxyCodeLine{180   \}}
\DoxyCodeLine{181   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{182     output\_interval = sim\_params[\textcolor{stringliteral}{"{}output\_interval"{}}].get\_int64();}
\DoxyCodeLine{183   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{184     output\_interval = 1;}
\DoxyCodeLine{185   \}}
\DoxyCodeLine{186   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{187     output\_mean\_only = sim\_params[\textcolor{stringliteral}{"{}output\_mean\_only"{}}].get\_bool();}
\DoxyCodeLine{188   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{189     output\_mean\_only = \textcolor{keyword}{false};}
\DoxyCodeLine{190   \}}
\DoxyCodeLine{191   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{192     output\_derivative = sim\_params[\textcolor{stringliteral}{"{}output\_derivative"{}}].get\_bool();}
\DoxyCodeLine{193   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{194     output\_derivative = \textcolor{keyword}{false};}
\DoxyCodeLine{195   \}}
\DoxyCodeLine{196   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{197     output\_last\_cycle\_only = sim\_params[\textcolor{stringliteral}{"{}output\_last\_cycle\_only"{}}].get\_bool();}
\DoxyCodeLine{198   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{199     output\_last\_cycle\_only = \textcolor{keyword}{false};}
\DoxyCodeLine{200   \}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202   \textcolor{comment}{// Create list to store block connections while generating blocks}}
\DoxyCodeLine{203   std::vector<std::tuple<std::string\_view, std::string\_view>> connections;}
\DoxyCodeLine{204   \textcolor{keywordtype}{int} block\_count = 0;}
\DoxyCodeLine{205 }
\DoxyCodeLine{206   \textcolor{comment}{// Create vessels}}
\DoxyCodeLine{207   std::map<std::int64\_t, std::string\_view> vessel\_id\_map;}
\DoxyCodeLine{208   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} vessel\_config : config[\textcolor{stringliteral}{"{}vessels"{}}]) \{}
\DoxyCodeLine{209     \textcolor{keyword}{auto} vessel\_values = vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_values"{}}];}
\DoxyCodeLine{210     std::string\_view vessel\_name = vessel\_config[\textcolor{stringliteral}{"{}vessel\_name"{}}].get\_string();}
\DoxyCodeLine{211     vessel\_id\_map.insert(\{vessel\_config[\textcolor{stringliteral}{"{}vessel\_id"{}}].get\_int64(), vessel\_name\});}
\DoxyCodeLine{212     \textcolor{keywordflow}{if} (std::string\_view(vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_type"{}}].get\_string()) ==}
\DoxyCodeLine{213         \textcolor{stringliteral}{"{}BloodVessel"{}}) \{}
\DoxyCodeLine{214       T R = vessel\_values[\textcolor{stringliteral}{"{}R\_poiseuille"{}}].get\_double();}
\DoxyCodeLine{215       T C;}
\DoxyCodeLine{216       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{217         C = vessel\_values[\textcolor{stringliteral}{"{}C"{}}].get\_double();}
\DoxyCodeLine{218       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{219         C = 0.0;}
\DoxyCodeLine{220       \}}
\DoxyCodeLine{221       T L;}
\DoxyCodeLine{222       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{223         L = vessel\_values[\textcolor{stringliteral}{"{}L"{}}].get\_double();}
\DoxyCodeLine{224       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{225         L = 0.0;}
\DoxyCodeLine{226       \}}
\DoxyCodeLine{227       T stenosis\_coefficient;}
\DoxyCodeLine{228       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{229         stenosis\_coefficient =}
\DoxyCodeLine{230             vessel\_values[\textcolor{stringliteral}{"{}stenosis\_coefficient"{}}].get\_double();}
\DoxyCodeLine{231       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{232         stenosis\_coefficient = 0.0;}
\DoxyCodeLine{233       \}}
\DoxyCodeLine{234       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel}{MODEL::BloodVessel<T>}}(}
\DoxyCodeLine{235           R = R, C = C, L = L, stenosis\_coefficient = stenosis\_coefficient,}
\DoxyCodeLine{236           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_name)));}
\DoxyCodeLine{237       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{238           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_name), block\_count\});}
\DoxyCodeLine{239       block\_count++;}
\DoxyCodeLine{240       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created vessel "{}} << vessel\_name);}
\DoxyCodeLine{241     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{242       \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown vessel type"{}});}
\DoxyCodeLine{243     \}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245     \textcolor{comment}{// Read connected boundary conditions}}
\DoxyCodeLine{246     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{247       \textcolor{keyword}{auto} inlet\_bc = vessel\_config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}][\textcolor{stringliteral}{"{}inlet"{}}];}
\DoxyCodeLine{248       connections.push\_back(\{inlet\_bc.get\_string(), vessel\_name\});}
\DoxyCodeLine{249     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{250     \}}
\DoxyCodeLine{251 }
\DoxyCodeLine{252     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{253       \textcolor{keyword}{auto} outlet\_bc = vessel\_config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}][\textcolor{stringliteral}{"{}outlet"{}}];}
\DoxyCodeLine{254       connections.push\_back(\{vessel\_name, outlet\_bc.get\_string()\});}
\DoxyCodeLine{255     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{256     \}}
\DoxyCodeLine{257   \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259   \textcolor{comment}{// Create map for boundary conditions to boundary condition type}}
\DoxyCodeLine{260   std::map<std::string\_view, std::string\_view> bc\_type\_map;}
\DoxyCodeLine{261   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bc\_config : config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}]) \{}
\DoxyCodeLine{262     bc\_type\_map.insert(\{bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}], bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]\});}
\DoxyCodeLine{263   \}}
\DoxyCodeLine{264   DEBUG\_MSG(\textcolor{stringliteral}{"{}Created BC name-\/>type map."{}});}
\DoxyCodeLine{265 }
\DoxyCodeLine{266   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{267     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} coupling\_config : config[\textcolor{stringliteral}{"{}external\_solver\_coupling\_blocks"{}}]) \{}
\DoxyCodeLine{268       std::string\_view coupling\_type = coupling\_config[\textcolor{stringliteral}{"{}type"{}}];}
\DoxyCodeLine{269       std::string\_view coupling\_name = coupling\_config[\textcolor{stringliteral}{"{}name"{}}];}
\DoxyCodeLine{270       std::string\_view coupling\_loc = coupling\_config[\textcolor{stringliteral}{"{}location"{}}];}
\DoxyCodeLine{271       \textcolor{keywordtype}{bool} periodic;}
\DoxyCodeLine{272       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{273         periodic = coupling\_config[\textcolor{stringliteral}{"{}periodic"{}}].get\_bool();}
\DoxyCodeLine{274       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{275         periodic = \textcolor{keyword}{true};}
\DoxyCodeLine{276       \}}
\DoxyCodeLine{277       \textcolor{keyword}{auto} coupling\_values = coupling\_config[\textcolor{stringliteral}{"{}values"{}}];}
\DoxyCodeLine{278 }
\DoxyCodeLine{279       \textcolor{comment}{// Create coupling block}}
\DoxyCodeLine{280       std::vector<T> t\_coupling;}
\DoxyCodeLine{281       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{282         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : coupling\_values[\textcolor{stringliteral}{"{}t"{}}]) \{}
\DoxyCodeLine{283           t\_coupling.push\_back(x.get\_double());}
\DoxyCodeLine{284         \}}
\DoxyCodeLine{285       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{286         t\_coupling.push\_back(0.0);}
\DoxyCodeLine{287       \};}
\DoxyCodeLine{288 }
\DoxyCodeLine{289       \textcolor{keywordflow}{if} (coupling\_type == \textcolor{stringliteral}{"{}FLOW"{}}) \{}
\DoxyCodeLine{290         std::vector<T> Q\_coupling;}
\DoxyCodeLine{291         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{292           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : coupling\_values[\textcolor{stringliteral}{"{}Q"{}}].get\_array()) \{}
\DoxyCodeLine{293             Q\_coupling.push\_back(x.get\_double());}
\DoxyCodeLine{294           \}}
\DoxyCodeLine{295         \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{296           Q\_coupling.push\_back(coupling\_values[\textcolor{stringliteral}{"{}Q"{}}].get\_double());}
\DoxyCodeLine{297         \}}
\DoxyCodeLine{298 }
\DoxyCodeLine{299         \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} q\_coupling\_param(t\_coupling, Q\_coupling,}
\DoxyCodeLine{300                                                        periodic);}
\DoxyCodeLine{301         \textcolor{keywordflow}{if} ((q\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_aee6221393da44b0e6279986782cb7c9a}{isconstant}} == \textcolor{keyword}{false}) \&\&}
\DoxyCodeLine{302             (q\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a42597c37d10af47c080660a6677e0b7a}{isperiodic}} == \textcolor{keyword}{true})) \{}
\DoxyCodeLine{303           \textcolor{keywordflow}{if} ((sim\_cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{304               (q\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}} != sim\_cardiac\_cycle\_period)) \{}
\DoxyCodeLine{305             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{306                 \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in "{}}}
\DoxyCodeLine{307                 \textcolor{stringliteral}{"{}TimeDependentParameter"{}});}
\DoxyCodeLine{308           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{309             sim\_cardiac\_cycle\_period = q\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}};}
\DoxyCodeLine{310           \}}
\DoxyCodeLine{311         \}}
\DoxyCodeLine{312         model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference_b_c}{MODEL::FlowReferenceBC<T>}}(}
\DoxyCodeLine{313             q\_coupling\_param, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name),}
\DoxyCodeLine{314             \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_loc)));}
\DoxyCodeLine{315         model-\/>block\_index\_map.insert(}
\DoxyCodeLine{316             \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name), block\_count\});}
\DoxyCodeLine{317         block\_count++;}
\DoxyCodeLine{318         model-\/>external\_coupling\_blocks.push\_back(}
\DoxyCodeLine{319             \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name));}
\DoxyCodeLine{320       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (coupling\_type == \textcolor{stringliteral}{"{}PRESSURE"{}}) \{}
\DoxyCodeLine{321         std::vector<T> P\_coupling;}
\DoxyCodeLine{322         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{323           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : coupling\_values[\textcolor{stringliteral}{"{}P"{}}].get\_array()) \{}
\DoxyCodeLine{324             P\_coupling.push\_back(x.get\_double());}
\DoxyCodeLine{325           \}}
\DoxyCodeLine{326         \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{327           P\_coupling.push\_back(coupling\_values[\textcolor{stringliteral}{"{}P"{}}].get\_double());}
\DoxyCodeLine{328         \}}
\DoxyCodeLine{329         \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} p\_coupling\_param(t\_coupling, P\_coupling,}
\DoxyCodeLine{330                                                        periodic);}
\DoxyCodeLine{331         \textcolor{keywordflow}{if} ((p\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_aee6221393da44b0e6279986782cb7c9a}{isconstant}} == \textcolor{keyword}{false}) \&\&}
\DoxyCodeLine{332             (p\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a42597c37d10af47c080660a6677e0b7a}{isperiodic}} == \textcolor{keyword}{true})) \{}
\DoxyCodeLine{333           \textcolor{keywordflow}{if} ((sim\_cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{334               (p\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}} != sim\_cardiac\_cycle\_period)) \{}
\DoxyCodeLine{335             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{336                 \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in "{}}}
\DoxyCodeLine{337                 \textcolor{stringliteral}{"{}TimeDependentParameter"{}});}
\DoxyCodeLine{338           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{339             sim\_cardiac\_cycle\_period = p\_coupling\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}};}
\DoxyCodeLine{340           \}}
\DoxyCodeLine{341         \}}
\DoxyCodeLine{342         model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_pressure_reference_b_c}{MODEL::PressureReferenceBC<T>}}(}
\DoxyCodeLine{343             p\_coupling\_param, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name),}
\DoxyCodeLine{344             \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_loc)));}
\DoxyCodeLine{345         model-\/>block\_index\_map.insert(}
\DoxyCodeLine{346             \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name), block\_count\});}
\DoxyCodeLine{347         block\_count++;}
\DoxyCodeLine{348         model-\/>external\_coupling\_blocks.push\_back(}
\DoxyCodeLine{349             \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(coupling\_name));}
\DoxyCodeLine{350       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{351         \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{352             \textcolor{stringliteral}{"{}Error. Flowsolver coupling block types should be FLOW or "{}}}
\DoxyCodeLine{353             \textcolor{stringliteral}{"{}PRESSURE."{}});}
\DoxyCodeLine{354       \}}
\DoxyCodeLine{355       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created coupling block "{}} << coupling\_name);}
\DoxyCodeLine{356 }
\DoxyCodeLine{357       \textcolor{comment}{// Determine the type of connected block}}
\DoxyCodeLine{358       std::string\_view connected\_block = coupling\_config[\textcolor{stringliteral}{"{}connected\_block"{}}];}
\DoxyCodeLine{359       std::string\_view connected\_type;}
\DoxyCodeLine{360       \textcolor{keywordtype}{int} found\_block = 0;}
\DoxyCodeLine{361       \textcolor{keywordflow}{if} (connected\_block == \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}}) \{}
\DoxyCodeLine{362         connected\_type = \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}};}
\DoxyCodeLine{363         found\_block = 1;}
\DoxyCodeLine{364       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{365         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{366           connected\_type = bc\_type\_map.at(connected\_block);}
\DoxyCodeLine{367           found\_block = 1;}
\DoxyCodeLine{368         \} \textcolor{keywordflow}{catch} (...) \{}
\DoxyCodeLine{369         \}}
\DoxyCodeLine{370         \textcolor{keywordflow}{if} (found\_block == 0) \{}
\DoxyCodeLine{371           \textcolor{comment}{// Search for connected\_block in the list of vessel names}}
\DoxyCodeLine{372           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \textcolor{keyword}{const} vessel : vessel\_id\_map) \{}
\DoxyCodeLine{373             \textcolor{keywordflow}{if} (connected\_block == vessel.second) \{}
\DoxyCodeLine{374               connected\_type = \textcolor{stringliteral}{"{}BloodVessel"{}};}
\DoxyCodeLine{375               found\_block = 1;}
\DoxyCodeLine{376               \textcolor{keywordflow}{break};}
\DoxyCodeLine{377             \}}
\DoxyCodeLine{378           \}}
\DoxyCodeLine{379         \}}
\DoxyCodeLine{380         \textcolor{keywordflow}{if} (found\_block == 0) \{}
\DoxyCodeLine{381           std::cout << \textcolor{stringliteral}{"{}Error! Could not connected type for block: "{}}}
\DoxyCodeLine{382                     << connected\_block << std::endl;}
\DoxyCodeLine{383           \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Terminating."{}});}
\DoxyCodeLine{384         \}}
\DoxyCodeLine{385       \}  \textcolor{comment}{// connected\_block != "{}ClosedLoopHeartAndPulmonary"{}}}
\DoxyCodeLine{386       \textcolor{comment}{// Create connections}}
\DoxyCodeLine{387       \textcolor{keywordflow}{if} (coupling\_loc == \textcolor{stringliteral}{"{}inlet"{}}) \{}
\DoxyCodeLine{388         std::vector<std::string\_view> possible\_types = \{}
\DoxyCodeLine{389             \textcolor{stringliteral}{"{}RESISTANCE"{}},    \textcolor{stringliteral}{"{}RCR"{}},      \textcolor{stringliteral}{"{}ClosedLoopRCR"{}},}
\DoxyCodeLine{390             \textcolor{stringliteral}{"{}SimplifiedRCR"{}}, \textcolor{stringliteral}{"{}CORONARY"{}}, \textcolor{stringliteral}{"{}ClosedLoopCoronary"{}},}
\DoxyCodeLine{391             \textcolor{stringliteral}{"{}BloodVessel"{}}\};}
\DoxyCodeLine{392         \textcolor{keywordflow}{if} (std::find(std::begin(possible\_types), std::end(possible\_types),}
\DoxyCodeLine{393                       connected\_type) == std::end(possible\_types)) \{}
\DoxyCodeLine{394           \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{395               \textcolor{stringliteral}{"{}Error: The specified connection type for inlet "{}}}
\DoxyCodeLine{396               \textcolor{stringliteral}{"{}external\_coupling\_block is invalid."{}});}
\DoxyCodeLine{397         \}}
\DoxyCodeLine{398         connections.push\_back(\{coupling\_name, connected\_block\});}
\DoxyCodeLine{399         DEBUG\_MSG(\textcolor{stringliteral}{"{}Created coupling block connection: "{}} << coupling\_name << \textcolor{stringliteral}{"{}-\/>"{}}}
\DoxyCodeLine{400                                                         << connected\_block);}
\DoxyCodeLine{401       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (coupling\_loc == \textcolor{stringliteral}{"{}outlet"{}}) \{}
\DoxyCodeLine{402         std::vector<std::string\_view> possible\_types = \{}
\DoxyCodeLine{403             \textcolor{stringliteral}{"{}ClosedLoopRCR"{}}, \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}}, \textcolor{stringliteral}{"{}BloodVessel"{}}\};}
\DoxyCodeLine{404         \textcolor{keywordflow}{if} (std::find(std::begin(possible\_types), std::end(possible\_types),}
\DoxyCodeLine{405                       connected\_type) == std::end(possible\_types)) \{}
\DoxyCodeLine{406           \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{407               \textcolor{stringliteral}{"{}Error: The specified connection type for outlet "{}}}
\DoxyCodeLine{408               \textcolor{stringliteral}{"{}external\_coupling\_block is invalid."{}});}
\DoxyCodeLine{409         \}}
\DoxyCodeLine{410         \textcolor{comment}{// Add connection only for closedLoopRCR and BloodVessel. Connection to}}
\DoxyCodeLine{411         \textcolor{comment}{// ClosedLoopHeartAndPulmonary will be handled in}}
\DoxyCodeLine{412         \textcolor{comment}{// ClosedLoopHeartAndPulmonary creation.}}
\DoxyCodeLine{413         \textcolor{keywordflow}{if} ((connected\_type == \textcolor{stringliteral}{"{}ClosedLoopRCR"{}}) ||}
\DoxyCodeLine{414             (connected\_type == \textcolor{stringliteral}{"{}BloodVessel"{}})) \{}
\DoxyCodeLine{415           connections.push\_back(\{connected\_block, coupling\_name\});}
\DoxyCodeLine{416           DEBUG\_MSG(\textcolor{stringliteral}{"{}Created coupling block connection: "{}}}
\DoxyCodeLine{417                     << connected\_block << \textcolor{stringliteral}{"{}-\/> "{}} << coupling\_name);}
\DoxyCodeLine{418         \}  \textcolor{comment}{// connected\_type == "{}ClosedLoopRCR"{}}}
\DoxyCodeLine{419       \}    \textcolor{comment}{// coupling\_loc}}
\DoxyCodeLine{420     \}  \textcolor{comment}{// for (auto coupling\_config : config["{}external\_solver\_coupling\_blocks"{}])}}
\DoxyCodeLine{421   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{422   \}}
\DoxyCodeLine{423   DEBUG\_MSG(\textcolor{stringliteral}{"{}Finished creating external coupling blocks."{}});}
\DoxyCodeLine{424 }
\DoxyCodeLine{425   std::vector<std::string\_view> closed\_loop\_bcs;}
\DoxyCodeLine{426 }
\DoxyCodeLine{427   \textcolor{comment}{// Create boundary conditions}}
\DoxyCodeLine{428   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bc\_config : config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}]) \{}
\DoxyCodeLine{429     std::string\_view bc\_type = bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}];}
\DoxyCodeLine{430     std::string\_view bc\_name = bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}];}
\DoxyCodeLine{431     \textcolor{keyword}{auto} bc\_values = bc\_config[\textcolor{stringliteral}{"{}bc\_values"{}}];}
\DoxyCodeLine{432 }
\DoxyCodeLine{433     std::vector<T> t;}
\DoxyCodeLine{434     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{435       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}t"{}}]) \{}
\DoxyCodeLine{436         t.push\_back(x.get\_double());}
\DoxyCodeLine{437       \}}
\DoxyCodeLine{438     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{439       t.push\_back(0.0);}
\DoxyCodeLine{440     \};}
\DoxyCodeLine{441 }
\DoxyCodeLine{442     \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}RCR"{}}) \{}
\DoxyCodeLine{443       T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}], Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}],}
\DoxyCodeLine{444         Pd = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{445       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_windkessel_b_c}{MODEL::WindkesselBC<T>}}(}
\DoxyCodeLine{446           Rp = Rp, C = C, Rd = Rd, Pd = Pd, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{447       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{448           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{449       block\_count++;}
\DoxyCodeLine{450       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{451     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}ClosedLoopRCR"{}}) \{}
\DoxyCodeLine{452       T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}], Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}];}
\DoxyCodeLine{453       \textcolor{keywordtype}{bool} closed\_loop\_outlet = bc\_values[\textcolor{stringliteral}{"{}closed\_loop\_outlet"{}}];}
\DoxyCodeLine{454       \textcolor{keywordflow}{if} (closed\_loop\_outlet == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{455         closed\_loop\_bcs.push\_back(bc\_name);}
\DoxyCodeLine{456       \}}
\DoxyCodeLine{457       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_r_c_r_b_c}{MODEL::ClosedLoopRCRBC<T>}}(}
\DoxyCodeLine{458           Rp = Rp, C = C, Rd = Rd, closed\_loop\_outlet = closed\_loop\_outlet,}
\DoxyCodeLine{459           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{460       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{461           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{462       block\_count++;}
\DoxyCodeLine{463       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{464     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}FLOW"{}}) \{}
\DoxyCodeLine{465       std::vector<T> Q;}
\DoxyCodeLine{466       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{467         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}Q"{}}].get\_array()) \{}
\DoxyCodeLine{468           Q.push\_back(x.get\_double());}
\DoxyCodeLine{469         \}}
\DoxyCodeLine{470       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{471         Q.push\_back(bc\_values[\textcolor{stringliteral}{"{}Q"{}}].get\_double());}
\DoxyCodeLine{472       \}}
\DoxyCodeLine{473 }
\DoxyCodeLine{474       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} q\_param(t, Q);}
\DoxyCodeLine{475       \textcolor{keywordflow}{if} ((q\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_aee6221393da44b0e6279986782cb7c9a}{isconstant}} == \textcolor{keyword}{false}) \&\& (q\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a42597c37d10af47c080660a6677e0b7a}{isperiodic}} == \textcolor{keyword}{true})) \{}
\DoxyCodeLine{476         \textcolor{keywordflow}{if} ((sim\_cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{477             (q\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}} != sim\_cardiac\_cycle\_period)) \{}
\DoxyCodeLine{478           \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{479               \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in "{}}}
\DoxyCodeLine{480               \textcolor{stringliteral}{"{}TimeDependentParameter"{}});}
\DoxyCodeLine{481         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{482           sim\_cardiac\_cycle\_period = q\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}};}
\DoxyCodeLine{483         \}}
\DoxyCodeLine{484       \}}
\DoxyCodeLine{485       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference_b_c}{MODEL::FlowReferenceBC<T>}}(}
\DoxyCodeLine{486           q\_param, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{487       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{488           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{489       block\_count++;}
\DoxyCodeLine{490       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{491 }
\DoxyCodeLine{492     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}RESISTANCE"{}}) \{}
\DoxyCodeLine{493       std::vector<T> R;}
\DoxyCodeLine{494       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{495         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}R"{}}].get\_array()) \{}
\DoxyCodeLine{496           R.push\_back(x.get\_double());}
\DoxyCodeLine{497         \}}
\DoxyCodeLine{498       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{499         R.push\_back(bc\_values[\textcolor{stringliteral}{"{}R"{}}].get\_double());}
\DoxyCodeLine{500       \}}
\DoxyCodeLine{501       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} r\_param(t, R);}
\DoxyCodeLine{502 }
\DoxyCodeLine{503       std::vector<T> Pd;}
\DoxyCodeLine{504       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{505         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}Pd"{}}].get\_array()) \{}
\DoxyCodeLine{506           Pd.push\_back(x.get\_double());}
\DoxyCodeLine{507         \}}
\DoxyCodeLine{508       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{509         Pd.push\_back(bc\_values[\textcolor{stringliteral}{"{}Pd"{}}].get\_double());}
\DoxyCodeLine{510       \}}
\DoxyCodeLine{511       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} pd\_param(t, Pd);}
\DoxyCodeLine{512       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistance_b_c}{MODEL::ResistanceBC<T>}}(}
\DoxyCodeLine{513           r\_param, pd\_param, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{514       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{515           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{516       block\_count++;}
\DoxyCodeLine{517       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{518     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}PRESSURE"{}}) \{}
\DoxyCodeLine{519       std::vector<T> P;}
\DoxyCodeLine{520       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{521         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}P"{}}].get\_array()) \{}
\DoxyCodeLine{522           P.push\_back(x.get\_double());}
\DoxyCodeLine{523         \}}
\DoxyCodeLine{524       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{525         P.push\_back(bc\_values[\textcolor{stringliteral}{"{}P"{}}].get\_double());}
\DoxyCodeLine{526       \}}
\DoxyCodeLine{527       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} p\_param(t, P);}
\DoxyCodeLine{528       \textcolor{keywordflow}{if} ((p\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_aee6221393da44b0e6279986782cb7c9a}{isconstant}} == \textcolor{keyword}{false}) \&\& (p\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a42597c37d10af47c080660a6677e0b7a}{isperiodic}} == \textcolor{keyword}{true})) \{}
\DoxyCodeLine{529         \textcolor{comment}{// if (p\_param.isconstant == false) \{}}
\DoxyCodeLine{530         \textcolor{keywordflow}{if} ((sim\_cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{531             (p\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}} != sim\_cardiac\_cycle\_period)) \{}
\DoxyCodeLine{532           \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{533               \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in "{}}}
\DoxyCodeLine{534               \textcolor{stringliteral}{"{}TimeDependentParameter"{}});}
\DoxyCodeLine{535         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{536           sim\_cardiac\_cycle\_period = p\_param.\mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter_a2d104c267b7ac6a0ed71b05acd1cb36c}{cycle\_period}};}
\DoxyCodeLine{537         \}}
\DoxyCodeLine{538       \}}
\DoxyCodeLine{539       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_pressure_reference_b_c}{MODEL::PressureReferenceBC<T>}}(}
\DoxyCodeLine{540           p\_param, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{541       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{542           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{543       block\_count++;}
\DoxyCodeLine{544       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{545     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}CORONARY"{}}) \{}
\DoxyCodeLine{546       T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra1"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ra2"{}}], Rv = bc\_values[\textcolor{stringliteral}{"{}Rv1"{}}],}
\DoxyCodeLine{547         Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}], Cim = bc\_values[\textcolor{stringliteral}{"{}Cc"{}}];}
\DoxyCodeLine{548       \textcolor{keyword}{auto} Pim\_json = bc\_values[\textcolor{stringliteral}{"{}Pim"{}}], Pv\_json = bc\_values[\textcolor{stringliteral}{"{}P\_v"{}}];}
\DoxyCodeLine{549 }
\DoxyCodeLine{550       std::vector<T> Pim;}
\DoxyCodeLine{551       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{552         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}Pim"{}}].get\_array()) \{}
\DoxyCodeLine{553           Pim.push\_back(x.get\_double());}
\DoxyCodeLine{554         \}}
\DoxyCodeLine{555       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{556         Pim.push\_back(bc\_values[\textcolor{stringliteral}{"{}Pim"{}}].get\_double());}
\DoxyCodeLine{557       \}}
\DoxyCodeLine{558       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} pim\_param(t, Pim);}
\DoxyCodeLine{559       std::vector<T> P\_v;}
\DoxyCodeLine{560       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{561         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : bc\_values[\textcolor{stringliteral}{"{}P\_v"{}}].get\_array()) \{}
\DoxyCodeLine{562           P\_v.push\_back(x.get\_double());}
\DoxyCodeLine{563         \}}
\DoxyCodeLine{564       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{565         P\_v.push\_back(bc\_values[\textcolor{stringliteral}{"{}P\_v"{}}].get\_double());}
\DoxyCodeLine{566       \}}
\DoxyCodeLine{567       \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter}} pv\_param(t, P\_v);}
\DoxyCodeLine{568 }
\DoxyCodeLine{569       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_open_loop_coronary_b_c}{MODEL::OpenLoopCoronaryBC<T>}}(}
\DoxyCodeLine{570           Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca, Cim = Cim, pim\_param, pv\_param,}
\DoxyCodeLine{571           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{572       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{573           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{574       block\_count++;}
\DoxyCodeLine{575       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{576     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bc\_type == \textcolor{stringliteral}{"{}ClosedLoopCoronary"{}}) \{}
\DoxyCodeLine{577       T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ram"{}}], Rv = bc\_values[\textcolor{stringliteral}{"{}Rv"{}}],}
\DoxyCodeLine{578         Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}], Cim = bc\_values[\textcolor{stringliteral}{"{}Cim"{}}];}
\DoxyCodeLine{579       std::string\_view side = bc\_values[\textcolor{stringliteral}{"{}side"{}}];}
\DoxyCodeLine{580       closed\_loop\_bcs.push\_back(bc\_name);}
\DoxyCodeLine{581       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_coronary_b_c}{MODEL::ClosedLoopCoronaryBC<T>}}(}
\DoxyCodeLine{582           Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca, Cim = Cim,}
\DoxyCodeLine{583           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(side), \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name)));}
\DoxyCodeLine{584       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{585           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_name), block\_count\});}
\DoxyCodeLine{586       block\_count++;}
\DoxyCodeLine{587       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{588     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{589       \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown boundary condition type"{}});}
\DoxyCodeLine{590     \}}
\DoxyCodeLine{591   \}}
\DoxyCodeLine{592 }
\DoxyCodeLine{593   \textcolor{comment}{// Create junctions}}
\DoxyCodeLine{594   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}]) \{}
\DoxyCodeLine{595     std::string\_view j\_type = junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}].get\_string();}
\DoxyCodeLine{596     std::string\_view junction\_name =}
\DoxyCodeLine{597         junction\_config[\textcolor{stringliteral}{"{}junction\_name"{}}].get\_string();}
\DoxyCodeLine{598     \textcolor{keywordflow}{if} ((j\_type == \textcolor{stringliteral}{"{}NORMAL\_JUNCTION"{}}) || (j\_type == \textcolor{stringliteral}{"{}internal\_junction"{}})) \{}
\DoxyCodeLine{599       model-\/>blocks.push\_back(}
\DoxyCodeLine{600           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name)));}
\DoxyCodeLine{601       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{602           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name), block\_count\});}
\DoxyCodeLine{603       block\_count++;}
\DoxyCodeLine{604     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j\_type == \textcolor{stringliteral}{"{}resistive\_junction"{}}) \{}
\DoxyCodeLine{605       std::vector<T> R;}
\DoxyCodeLine{606       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : junction\_config[\textcolor{stringliteral}{"{}junction\_values"{}}][\textcolor{stringliteral}{"{}R"{}}].get\_array()) \{}
\DoxyCodeLine{607         R.push\_back(x.get\_double());}
\DoxyCodeLine{608       \}}
\DoxyCodeLine{609       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistive_junction}{MODEL::ResistiveJunction<T>}}(}
\DoxyCodeLine{610           R, \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name)));}
\DoxyCodeLine{611       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{612           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name), block\_count\});}
\DoxyCodeLine{613       block\_count++;}
\DoxyCodeLine{614     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j\_type == \textcolor{stringliteral}{"{}BloodVesselJunction"{}}) \{}
\DoxyCodeLine{615       std::vector<T> R;}
\DoxyCodeLine{616       std::vector<T> C;}
\DoxyCodeLine{617       std::vector<T> L;}
\DoxyCodeLine{618       std::vector<T> stenosis\_coefficient;}
\DoxyCodeLine{619       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x :}
\DoxyCodeLine{620            junction\_config[\textcolor{stringliteral}{"{}junction\_values"{}}][\textcolor{stringliteral}{"{}R\_poiseuille"{}}].get\_array()) \{}
\DoxyCodeLine{621         R.push\_back(x.get\_double());}
\DoxyCodeLine{622       \}}
\DoxyCodeLine{623       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : junction\_config[\textcolor{stringliteral}{"{}junction\_values"{}}][\textcolor{stringliteral}{"{}C"{}}].get\_array()) \{}
\DoxyCodeLine{624         C.push\_back(x.get\_double());}
\DoxyCodeLine{625       \}}
\DoxyCodeLine{626       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : junction\_config[\textcolor{stringliteral}{"{}junction\_values"{}}][\textcolor{stringliteral}{"{}L"{}}].get\_array()) \{}
\DoxyCodeLine{627         L.push\_back(x.get\_double());}
\DoxyCodeLine{628       \}}
\DoxyCodeLine{629       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} x : junction\_config[\textcolor{stringliteral}{"{}junction\_values"{}}][\textcolor{stringliteral}{"{}stenosis\_coefficient"{}}]}
\DoxyCodeLine{630                         .get\_array()) \{}
\DoxyCodeLine{631         stenosis\_coefficient.push\_back(x.get\_double());}
\DoxyCodeLine{632       \}}
\DoxyCodeLine{633       model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL::BloodVesselJunction<T>}}(}
\DoxyCodeLine{634           R, C, L, stenosis\_coefficient,}
\DoxyCodeLine{635           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name)));}
\DoxyCodeLine{636       model-\/>block\_index\_map.insert(}
\DoxyCodeLine{637           \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_name), block\_count\});}
\DoxyCodeLine{638       block\_count++;}
\DoxyCodeLine{639     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{640       \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown junction type"{}});}
\DoxyCodeLine{641     \}}
\DoxyCodeLine{642     \textcolor{comment}{// Check for connections to inlet and outlet vessels and append to}}
\DoxyCodeLine{643     \textcolor{comment}{// connections list}}
\DoxyCodeLine{644     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} inlet\_vessel : junction\_config[\textcolor{stringliteral}{"{}inlet\_vessels"{}}]) \{}
\DoxyCodeLine{645       connections.push\_back(}
\DoxyCodeLine{646           \{vessel\_id\_map[inlet\_vessel.get\_int64()], junction\_name\});}
\DoxyCodeLine{647     \}}
\DoxyCodeLine{648     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} outlet\_vessel : junction\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}]) \{}
\DoxyCodeLine{649       connections.push\_back(}
\DoxyCodeLine{650           \{junction\_name, vessel\_id\_map[outlet\_vessel.get\_int64()]\});}
\DoxyCodeLine{651     \}}
\DoxyCodeLine{652     DEBUG\_MSG(\textcolor{stringliteral}{"{}Created junction "{}} << junction\_name);}
\DoxyCodeLine{653   \}}
\DoxyCodeLine{654 }
\DoxyCodeLine{655   \textcolor{comment}{// Create closed-\/loop blocks}}
\DoxyCodeLine{656   \textcolor{keywordtype}{bool} heartpulmonary\_block\_present =}
\DoxyCodeLine{657       \textcolor{keyword}{false};  \textcolor{comment}{///< Flag to check if heart block is present (requires different}\textcolor{comment}{}}
\DoxyCodeLine{658 \textcolor{comment}{              ///< handling)}}
\DoxyCodeLine{659 \textcolor{comment}{}  \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{660     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} closed\_loop\_config : config[\textcolor{stringliteral}{"{}closed\_loop\_blocks"{}}]) \{}
\DoxyCodeLine{661       std::string\_view closed\_loop\_type =}
\DoxyCodeLine{662           closed\_loop\_config[\textcolor{stringliteral}{"{}closed\_loop\_type"{}}];}
\DoxyCodeLine{663       \textcolor{keywordflow}{if} (closed\_loop\_type == \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}}) \{}
\DoxyCodeLine{664         \textcolor{keywordflow}{if} (heartpulmonary\_block\_present == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{665           heartpulmonary\_block\_present = \textcolor{keyword}{true};}
\DoxyCodeLine{666           \textcolor{keywordflow}{if} (sim\_steady\_initial == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{667             std::runtime\_error(}
\DoxyCodeLine{668                 \textcolor{stringliteral}{"{}ERROR: Steady initial condition is not compatible with "{}}}
\DoxyCodeLine{669                 \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary block."{}});}
\DoxyCodeLine{670           \}}
\DoxyCodeLine{671           sim\_steady\_initial = \textcolor{keyword}{false};}
\DoxyCodeLine{672           std::string\_view heartpulmonary\_name = \textcolor{stringliteral}{"{}CLH"{}};}
\DoxyCodeLine{673           T cycle\_period =}
\DoxyCodeLine{674               closed\_loop\_config[\textcolor{stringliteral}{"{}cardiac\_cycle\_period"{}}].get\_double();}
\DoxyCodeLine{675           \textcolor{keywordflow}{if} ((sim\_cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{676               (cycle\_period != sim\_cardiac\_cycle\_period)) \{}
\DoxyCodeLine{677             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{678                 \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in "{}}}
\DoxyCodeLine{679                 \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary."{}});}
\DoxyCodeLine{680           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{681             sim\_cardiac\_cycle\_period = cycle\_period;}
\DoxyCodeLine{682           \}}
\DoxyCodeLine{683           \textcolor{keyword}{auto} heart\_params = closed\_loop\_config[\textcolor{stringliteral}{"{}parameters"{}}];}
\DoxyCodeLine{684           \textcolor{comment}{// Convert to std::map to keep model blocks independent of simdjson}}
\DoxyCodeLine{685           std::map<std::string, T> param\_values;}
\DoxyCodeLine{686           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Tsa"{}}, heart\_params[\textcolor{stringliteral}{"{}Tsa"{}}]));}
\DoxyCodeLine{687           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}tpwave"{}}, heart\_params[\textcolor{stringliteral}{"{}tpwave"{}}]));}
\DoxyCodeLine{688           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Erv\_s"{}}, heart\_params[\textcolor{stringliteral}{"{}Erv\_s"{}}]));}
\DoxyCodeLine{689           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Elv\_s"{}}, heart\_params[\textcolor{stringliteral}{"{}Elv\_s"{}}]));}
\DoxyCodeLine{690           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}iml"{}}, heart\_params[\textcolor{stringliteral}{"{}iml"{}}]));}
\DoxyCodeLine{691           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}imr"{}}, heart\_params[\textcolor{stringliteral}{"{}imr"{}}]));}
\DoxyCodeLine{692           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Lra\_v"{}}, heart\_params[\textcolor{stringliteral}{"{}Lra\_v"{}}]));}
\DoxyCodeLine{693           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Rra\_v"{}}, heart\_params[\textcolor{stringliteral}{"{}Rra\_v"{}}]));}
\DoxyCodeLine{694           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Lrv\_a"{}}, heart\_params[\textcolor{stringliteral}{"{}Lrv\_a"{}}]));}
\DoxyCodeLine{695           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Rrv\_a"{}}, heart\_params[\textcolor{stringliteral}{"{}Rrv\_a"{}}]));}
\DoxyCodeLine{696           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Lla\_v"{}}, heart\_params[\textcolor{stringliteral}{"{}Lla\_v"{}}]));}
\DoxyCodeLine{697           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Rla\_v"{}}, heart\_params[\textcolor{stringliteral}{"{}Rla\_v"{}}]));}
\DoxyCodeLine{698           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Llv\_a"{}}, heart\_params[\textcolor{stringliteral}{"{}Llv\_a"{}}]));}
\DoxyCodeLine{699           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Rlv\_ao"{}}, heart\_params[\textcolor{stringliteral}{"{}Rlv\_ao"{}}]));}
\DoxyCodeLine{700           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Vrv\_u"{}}, heart\_params[\textcolor{stringliteral}{"{}Vrv\_u"{}}]));}
\DoxyCodeLine{701           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Vlv\_u"{}}, heart\_params[\textcolor{stringliteral}{"{}Vlv\_u"{}}]));}
\DoxyCodeLine{702           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Rpd"{}}, heart\_params[\textcolor{stringliteral}{"{}Rpd"{}}]));}
\DoxyCodeLine{703           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Cp"{}}, heart\_params[\textcolor{stringliteral}{"{}Cp"{}}]));}
\DoxyCodeLine{704           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Cpa"{}}, heart\_params[\textcolor{stringliteral}{"{}Cpa"{}}]));}
\DoxyCodeLine{705           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Kxp\_ra"{}}, heart\_params[\textcolor{stringliteral}{"{}Kxp\_ra"{}}]));}
\DoxyCodeLine{706           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Kxv\_ra"{}}, heart\_params[\textcolor{stringliteral}{"{}Kxv\_ra"{}}]));}
\DoxyCodeLine{707           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Kxp\_la"{}}, heart\_params[\textcolor{stringliteral}{"{}Kxp\_la"{}}]));}
\DoxyCodeLine{708           param\_values.insert(std::make\_pair(\textcolor{stringliteral}{"{}Kxv\_la"{}}, heart\_params[\textcolor{stringliteral}{"{}Kxv\_la"{}}]));}
\DoxyCodeLine{709           param\_values.insert(}
\DoxyCodeLine{710               std::make\_pair(\textcolor{stringliteral}{"{}Emax\_ra"{}}, heart\_params[\textcolor{stringliteral}{"{}Emax\_ra"{}}]));}
\DoxyCodeLine{711           param\_values.insert(}
\DoxyCodeLine{712               std::make\_pair(\textcolor{stringliteral}{"{}Emax\_la"{}}, heart\_params[\textcolor{stringliteral}{"{}Emax\_la"{}}]));}
\DoxyCodeLine{713           param\_values.insert(}
\DoxyCodeLine{714               std::make\_pair(\textcolor{stringliteral}{"{}Vaso\_ra"{}}, heart\_params[\textcolor{stringliteral}{"{}Vaso\_ra"{}}]));}
\DoxyCodeLine{715           param\_values.insert(}
\DoxyCodeLine{716               std::make\_pair(\textcolor{stringliteral}{"{}Vaso\_la"{}}, heart\_params[\textcolor{stringliteral}{"{}Vaso\_la"{}}]));}
\DoxyCodeLine{717           \textcolor{keywordflow}{if} (param\_values.size() == 27) \{}
\DoxyCodeLine{718             model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_heart_pulmonary}{MODEL::ClosedLoopHeartPulmonary<T>}}(}
\DoxyCodeLine{719                 param\_values, cycle\_period,}
\DoxyCodeLine{720                 \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heartpulmonary\_name)));}
\DoxyCodeLine{721             model-\/>block\_index\_map.insert(}
\DoxyCodeLine{722                 \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heartpulmonary\_name), block\_count\});}
\DoxyCodeLine{723             block\_count++;}
\DoxyCodeLine{724           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{725             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{726                 \textcolor{stringliteral}{"{}Error. ClosedLoopHeartAndPulmonary should have 27 parameters"{}});}
\DoxyCodeLine{727           \}}
\DoxyCodeLine{728           \textcolor{comment}{// Junction at inlet to heart}}
\DoxyCodeLine{729           std::string\_view heart\_inlet\_junction\_name = \textcolor{stringliteral}{"{}J\_heart\_inlet"{}};}
\DoxyCodeLine{730           connections.push\_back(}
\DoxyCodeLine{731               \{heart\_inlet\_junction\_name, heartpulmonary\_name\});}
\DoxyCodeLine{732           model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(}
\DoxyCodeLine{733               \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_inlet\_junction\_name)));}
\DoxyCodeLine{734           model-\/>block\_index\_map.insert(}
\DoxyCodeLine{735               \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_inlet\_junction\_name),}
\DoxyCodeLine{736                block\_count\});}
\DoxyCodeLine{737           block\_count++;}
\DoxyCodeLine{738           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_inlet\_elem : closed\_loop\_bcs) \{}
\DoxyCodeLine{739             connections.push\_back(}
\DoxyCodeLine{740                 \{heart\_inlet\_elem, heart\_inlet\_junction\_name\});}
\DoxyCodeLine{741           \}}
\DoxyCodeLine{742           \textcolor{comment}{// Junction at outlet from heart}}
\DoxyCodeLine{743           std::string\_view heart\_outlet\_junction\_name = \textcolor{stringliteral}{"{}J\_heart\_outlet"{}};}
\DoxyCodeLine{744           connections.push\_back(}
\DoxyCodeLine{745               \{heartpulmonary\_name, heart\_outlet\_junction\_name\});}
\DoxyCodeLine{746           model-\/>blocks.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(}
\DoxyCodeLine{747               \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_outlet\_junction\_name)));}
\DoxyCodeLine{748           model-\/>block\_index\_map.insert(}
\DoxyCodeLine{749               \{\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_outlet\_junction\_name),}
\DoxyCodeLine{750                block\_count\});}
\DoxyCodeLine{751           block\_count++;}
\DoxyCodeLine{752           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_outlet\_block : closed\_loop\_config[\textcolor{stringliteral}{"{}outlet\_blocks"{}}]) \{}
\DoxyCodeLine{753             connections.push\_back(}
\DoxyCodeLine{754                 \{heart\_outlet\_junction\_name, heart\_outlet\_block\});}
\DoxyCodeLine{755           \}}
\DoxyCodeLine{756         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{757           \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{758               \textcolor{stringliteral}{"{}Error. Only one ClosedLoopHeartAndPulmonary can be included."{}});}
\DoxyCodeLine{759         \}}
\DoxyCodeLine{760       \}}
\DoxyCodeLine{761     \}}
\DoxyCodeLine{762   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{763   \}}
\DoxyCodeLine{764 }
\DoxyCodeLine{765   \textcolor{comment}{// Create Connections}}
\DoxyCodeLine{766   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&connection : connections) \{}
\DoxyCodeLine{767     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&ele1 : model-\/>blocks) \{}
\DoxyCodeLine{768       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&ele2 : model-\/>blocks) \{}
\DoxyCodeLine{769         \textcolor{keywordflow}{if} ((ele1-\/>name == std::get<0>(connection)) \&\&}
\DoxyCodeLine{770             (ele2-\/>name == std::get<1>(connection))) \{}
\DoxyCodeLine{771           model-\/>nodes.push\_back(}
\DoxyCodeLine{772               \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_node}{MODEL::Node}}(ele1-\/>name + \textcolor{stringliteral}{"{}:"{}} + ele2-\/>name));}
\DoxyCodeLine{773           DEBUG\_MSG(\textcolor{stringliteral}{"{}Created node "{}} << model-\/>nodes.back()-\/>name);}
\DoxyCodeLine{774           ele1-\/>outlet\_nodes.push\_back(model-\/>nodes.back());}
\DoxyCodeLine{775           ele2-\/>inlet\_nodes.push\_back(model-\/>nodes.back());}
\DoxyCodeLine{776           model-\/>nodes.back()-\/>setup\_dofs(model-\/>dofhandler);}
\DoxyCodeLine{777         \}}
\DoxyCodeLine{778       \}}
\DoxyCodeLine{779     \}}
\DoxyCodeLine{780   \}}
\DoxyCodeLine{781 }
\DoxyCodeLine{782   \textcolor{comment}{// Setup degrees of freedom of the system}}
\DoxyCodeLine{783   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : model-\/>blocks) \{}
\DoxyCodeLine{784     block-\/>setup\_dofs(model-\/>dofhandler);}
\DoxyCodeLine{785   \}}
\DoxyCodeLine{786 }
\DoxyCodeLine{787   \textcolor{comment}{// Set value of cardiac cycle period}}
\DoxyCodeLine{788   \textcolor{keywordflow}{if} (sim\_cardiac\_cycle\_period < 0.0) \{}
\DoxyCodeLine{789     sim\_cardiac\_cycle\_period =}
\DoxyCodeLine{790         1.0;  \textcolor{comment}{// If it has not been read from config or TimeDependentParameter}}
\DoxyCodeLine{791               \textcolor{comment}{// yet, set as default value of 1.0}}
\DoxyCodeLine{792   \}}
\DoxyCodeLine{793   \textcolor{comment}{// Calculate time step size}}
\DoxyCodeLine{794   \textcolor{keywordflow}{if} (!sim\_coupled) \{}
\DoxyCodeLine{795     sim\_time\_step\_size =}
\DoxyCodeLine{796         sim\_cardiac\_cycle\_period / (T(sim\_pts\_per\_cycle) -\/ 1.0);}
\DoxyCodeLine{797   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{798     sim\_time\_step\_size = sim\_external\_step\_size / (T(sim\_num\_time\_steps) -\/ 1.0);}
\DoxyCodeLine{799   \}}
\DoxyCodeLine{800 }
\DoxyCodeLine{801   \textcolor{comment}{// Update block parameters that depend on DOFs and other params of other}}
\DoxyCodeLine{802   \textcolor{comment}{// blocks For example, coronary block params that depend on heart block DOFs}}
\DoxyCodeLine{803   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : model-\/>blocks) \{}
\DoxyCodeLine{804     block-\/>set\_model\_dependent\_params(*model);}
\DoxyCodeLine{805   \}}
\DoxyCodeLine{806 }
\DoxyCodeLine{807   \textcolor{comment}{// Read initial condition}}
\DoxyCodeLine{808   initial\_state = \mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_state_a8b9bcbe746b0d2b87f7c0381ddf471a3}{ALGEBRA::State<T>::Zero}}(model-\/>dofhandler.size());}
\DoxyCodeLine{809   \textcolor{comment}{// Initialize blocks that have fixed initial conditions}}
\DoxyCodeLine{810   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : model-\/>blocks) \{}
\DoxyCodeLine{811     block-\/>set\_ICs(initial\_state);}
\DoxyCodeLine{812   \}}
\DoxyCodeLine{813   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{814     \textcolor{keyword}{auto} initial\_condition = config[\textcolor{stringliteral}{"{}initial\_condition"{}}].value();}
\DoxyCodeLine{815     \textcolor{comment}{// Check for pressure\_all or flow\_all condition.}}
\DoxyCodeLine{816     \textcolor{comment}{// This will initialize all pressure:* and flow:* variables.}}
\DoxyCodeLine{817     T init\_p, init\_q;}
\DoxyCodeLine{818     \textcolor{keywordtype}{bool} init\_p\_flag = \textcolor{keyword}{false};}
\DoxyCodeLine{819     \textcolor{keywordtype}{bool} init\_q\_flag = \textcolor{keyword}{false};}
\DoxyCodeLine{820     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{821       init\_p = initial\_condition[\textcolor{stringliteral}{"{}pressure\_all"{}}];}
\DoxyCodeLine{822       init\_p\_flag = \textcolor{keyword}{true};}
\DoxyCodeLine{823     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{824     \}}
\DoxyCodeLine{825     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{826       init\_q = initial\_condition[\textcolor{stringliteral}{"{}flow\_all"{}}];}
\DoxyCodeLine{827       init\_q\_flag = \textcolor{keyword}{true};}
\DoxyCodeLine{828     \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{829     \}}
\DoxyCodeLine{830     \textcolor{comment}{// Loop through variables and check for initial conditions.}}
\DoxyCodeLine{831     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < model-\/>dofhandler.size(); i++) \{}
\DoxyCodeLine{832       \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{833         initial\_state.y[i] = initial\_condition[model-\/>dofhandler.variables[i]];}
\DoxyCodeLine{834       \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{835         std::string var\_name = model-\/>dofhandler.variables[i];}
\DoxyCodeLine{836         \textcolor{keywordflow}{if} ((init\_p\_flag == \textcolor{keyword}{true}) \&\& ((var\_name.substr(0, 9) == \textcolor{stringliteral}{"{}pressure:"{}}) ||}
\DoxyCodeLine{837                                       (var\_name.substr(0, 4) == \textcolor{stringliteral}{"{}P\_c:"{}}))) \{}
\DoxyCodeLine{838           initial\_state.y[i] = init\_p;}
\DoxyCodeLine{839           DEBUG\_MSG(\textcolor{stringliteral}{"{}pressure\_all initial condition for "{}}}
\DoxyCodeLine{840                     << model-\/>dofhandler.variables[i]);}
\DoxyCodeLine{841         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((init\_q\_flag == \textcolor{keyword}{true}) \&\&}
\DoxyCodeLine{842                    (var\_name.substr(0, 5) == \textcolor{stringliteral}{"{}flow:"{}})) \{}
\DoxyCodeLine{843           initial\_state.y[i] = init\_q;}
\DoxyCodeLine{844           DEBUG\_MSG(\textcolor{stringliteral}{"{}flow\_all initial condition for "{}}}
\DoxyCodeLine{845                     << model-\/>dofhandler.variables[i]);}
\DoxyCodeLine{846         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{847           DEBUG\_MSG(\textcolor{stringliteral}{"{}No initial condition found for "{}}}
\DoxyCodeLine{848                     << model-\/>dofhandler.variables[i]);}
\DoxyCodeLine{849         \}}
\DoxyCodeLine{850       \}}
\DoxyCodeLine{851     \}}
\DoxyCodeLine{852   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{853   \}}
\DoxyCodeLine{854   DEBUG\_MSG(\textcolor{stringliteral}{"{}[configreader] END"{}});}
\DoxyCodeLine{855 \}}
\DoxyCodeLine{856 }
\DoxyCodeLine{857 \}  \textcolor{comment}{// namespace IO}}
\DoxyCodeLine{858 }
\DoxyCodeLine{859 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}

\end{DoxyCode}
